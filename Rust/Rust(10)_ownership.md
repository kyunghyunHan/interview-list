# 소유권

- 소유권은 Rust의 핵심 기능이다.
- 모든 프로그램은 실행중인 동안에는 컴퓨터의 메모리를 관리해야한다.
- 어떤 언어는 가비지 콜렉터를 이용해 더이상 사용되지 않는 메모리를 지속적으로 찾아 자동으로 해제한다.
- rust는 컴파일러가 컴파일 시점에 검사하는 다양한 규칙으로 이루어진 소유권 시스템에 의해 관리된다.

## 스택메모리와 힙 메모리

- 대부분 프로그래밍 언어에서는 스택 메모리와 힙 메모리를 자주 신경 쓸 필요가 없다.
- 하지만 Rust에서는 값이 스택메모리에 저장되었는지 힙 메모리에 저장되었는지에 따라 언어의 동작이나 의사 결정에 큰 영향을 미친다.
- 스택과 힙은 모두 코드가 런타임에 활용하는 메모리의 일부이며 각자 다른 방법으로 데이터를 구상한다.
- 스택은 유입된 순서대로 데이터를 저장하며데이터를 읽을떄는 그 반대 순서로 읽는다.그래서 마지막에 들어온 값을 먼저 읽는다.
- 마치 그릇을 쌓아놓고 쓰는 방법과 유사하다.
- 스택에 새로운 데이터를 넣는 동적을 푸시라 하며 데이터를 꺼내는 동작을 팝 이라한다.
- 스택에 저장되는 모든 데이터는 고정된 크기를 가져야한다.
- 컴파일 시점에 크기를 알수 없는 데이터나 런타임에 동적으로 크기가 변하는 데이터는 힙 메모리에 저장한다.
- 힙은 스택에 비하면 조금 더 복잡하다.
- 힙에 데이터를 넣는 동작은 메모리의 일정 공간을 할애할 것을 요청하는 것이다.
- 따라서 운영체제는 힙 메모리에서 일정한 공간을 찾아 사용중인 메모르로 표시한후 해당 메모리의 주솟값인 포인터를 넘겨준다.
- 이 과정을 힙 메모리 할당또는 할당 이라 칭한다.
- 스택에 값을 푸시하는 동작에는 할당이 발생하지 않는다.포인터는 이미 크기가 고정된 값이므로 포인터는 스택에 저장할수 있지만 실제 포인터가 가리키는 데이터가 필요할떄 포인터가 가리키는 메모리를 따라 가야한다.
- 포인터를 따라 가는 것은 레스토랑에 입장하며 일행이 몇명인지 말해주면 직원이 빈테이블을찾아 안내해주는 것과 비슷하다.
- 스택에 데이터를 푸시하는 것이 힙에 할당하는 것보다 빠른 이유는 운영체제가 새데이터를 저장할 공간을 찾을 필요가 없기 떄문이다.
- 새 데이터는 항상 스택 가장 위에 추가된다.
- 힙에 공간을 할당하는 것은 상대적으로 더 많은 작업이 필요하다.
- 힙 메모리에 저장된 데이터에 대한 접근은 스택에 저장된 데이터에 접근하는 것보다 느리다.그 이유는 포인터를 따라 가야하기 떄문이다.
- 프로세스 역시 멀리 떨어진 데이터를 처리할떄보다 다른 데이터에 가까운데이터를 처리할때 더 능률적으로 동작한다.
- 코드에서 함수를 로출할떄 이 함수에는 힙메모리에 저장된 데이터에 대한 포인터를 포함한 여러 값이 전달되며 이 값들은 함수의 로컬 변수에 할당되어 스택에 저장된다.
- 함수 실행이 완료되면 이 값들은 스택에서 제거된다.
- 코드 어느 부분이 힙 메모리에 저장된 데이터를 사용하는지 추적하고 힙에 저장되는 데이터의 중복을 최소화해 사용하지 않는 데이터를 힙 메모리에서 제거하면 메모리 부족 문제를 제거할수 있다.

## 소유권 규칙

- 1. Rust의 각각의 값은 해당값의 오너라고 불리우는 변수를 갖고잇다
- 2. 한번에딱 하나의 오너만 존재
- 3. 너가 스코프 밖으로 벗어나는 떄 값은 버려진다

## 변수의 범위

```rs
let s ="hello";
```

```rs
{                      // s는 유효하지 않습니다. 아직 선언이 안됐거든요.
    let s = "hello";   // s는 이 지점부터 유효합니다.

    // s를 가지고 뭔가 합니다.
}                      // 이 스코프는 이제 끝이므로, s는 더이상 유효하지 않습니다.
```

- 변수s가 범위 안으로 들어오면 유효하다
- 변수는 범위를 벗어나기 전까지 유요하다.

## Sting타입

## 메모리 할당

## 소유권과 함수

## 리턴값과 범위
